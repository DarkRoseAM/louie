// Auto generated by Louie
// PLEASE DO NOT EDIT, YOUR CHANGES WILL BE WIPED OUT AT A LATER STAGE!
#macro(commaIfNeeded $index $size)
#set( $lastone = $size - 1 )
#if( $index <= $lastone ),#end
#end


#if($info.usesDatatypes())
define(['app/louieclient','ProtoBuf','app/datatypes'], function(louieclient,protobuf,datatypes) {
#else
define(['app/louieclient','ProtoBuf'], function(louieclient,protobuf) {
#end

   var ${baseName}Client = function(host, port, gateway) {
        if (!host) host = "${info.getHost()}";
        if (!port) port = 8080;
        if (!gateway) gateway = "${info.getGateway()}";
        this.louie = new louieclient(host, port, gateway);
        this.service = "${serviceName}";
    };

#foreach($proto in $info.getProtos())
    var ${proto.getName()}Proto = protobuf.loadProtoFile("proto/$proto.getProtoFile()");
#foreach($pb in $proto.getPBs())
    ${baseName}Client.prototype.${pb.getName()} = ${proto.getName()}Proto.build("${pb.getFullName()}");
#end
#end

#foreach($method in $info.methodInfos)
    /*
      ${method.getDescription()}
    */
    ${baseName}Client.prototype.${method.name} = function(#foreach($param in $method.getParameters())${param.getName()},#end callback) {
#foreach($param in $method.getParameters()) 
#if ( ${method.isLouieDataType($param.getPbType())} )
        var ${param.getName()}Enc = new datatypes.${param.getPbType()}(${param.getName()}).encodeDelimited().toArrayBuffer();
#else 
        var ${param.getName()}Enc = new this.${param.getPbType()}(${param.getName()}).encodeDelimited().toArrayBuffer();
#end
#end
#set($paramCount = $method.getParameterCount())
        this.louie.request(this.service, "${method.name}", [#foreach($param in $method.getParameters())"${param.getFullName()}"#commaIfNeeded($velocityCount,$paramCount)#end], [#foreach($param in $method.getParameters())${param.getName()}Enc#commaIfNeeded($velocityCount, $paramCount)#end], this.${method.getPbReturnType()}, callback);
    };
    
#end
    return ${baseName}Client;

});